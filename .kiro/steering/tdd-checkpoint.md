---
inclusion: always
---

# TDD チェックポイント強制システム

## 🚨 コード実装前チェックリスト
**以下を満たさない限り、一切のコード実装を禁止**

### ✅ 必須確認事項
- [ ] 失敗するテストを書いた
- [ ] `npm test -- [ファイル名] --run` でテスト実行し、失敗を確認した
- [ ] テスト失敗の理由が「実装がないため」であることを確認した

### 🔄 実装サイクル
1. **RED**: テスト実行結果で失敗を確認
2. **GREEN**: 最小限の実装でテストを通す
3. **REFACTOR**: テストが通った状態でリファクタリング

## 🛑 強制停止条件
以下の場合は即座に作業を停止し、テストから始める：

- テストファイルが存在しない状態でコードを書こうとした
- テストを実行せずにコードを書いた
- テストが通っていない状態でコードを書いた
- 「理解しました」だけで実際の作業をしなかった

## 📝 必須応答フォーマット
```
## RED フェーズ
[テストコードを書く]
[テスト実行コマンド実行]
[失敗結果を確認]

## GREEN フェーズ  
[最小限の実装]
[テスト実行コマンド実行]
[成功結果を確認]

## REFACTOR フェーズ
[必要に応じてリファクタリング]
[テスト実行コマンド実行]
[成功結果を確認]
```

## ⚡ 自動チェック
- コード実装前に必ずテスト実行結果を示す
- 各フェーズで必ずテスト実行コマンドを実行する
- テスト結果を明示的に確認する

## 🌐 Playwright MCP必須使用
**E2Eテスト実装時は必ずPlaywright MCPを使用**

### 📋 Playwright MCP使用手順
1. **ブラウザ起動**: テスト対象ページにナビゲート
2. **実際の挙動確認**: ページの現在の状態をスナップショットで確認
3. **要素の存在確認**: テストで期待する要素が実際に存在するかチェック
4. **インタラクション確認**: クリック、入力などの操作が正常に動作するかテスト
5. **テスト実装**: 確認した実際の挙動に基づいてテストコードを作成

### 🔍 必須確認項目
- [ ] ページが正常にロードされるか
- [ ] 期待する要素（data-testid等）が存在するか
- [ ] ローディング状態が適切に表示されるか
- [ ] データが正しく表示されるか
- [ ] インタラクション（クリック、入力等）が動作するか

### 🚫 禁止事項
- Playwright MCPで実際の挙動を確認せずにテストを書くこと
- 推測や仮定に基づいてテストを実装すること
- ブラウザでの実際の動作確認なしにテストを修正すること